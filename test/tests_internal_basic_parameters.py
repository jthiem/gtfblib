import numpy as np
import gtfb

matparams_cf_32ch = [  80.00,  109.51,  141.84,  177.26,
                      216.07,  258.58,  305.16,  356.18,
                      412.09,  473.33,  540.43,  613.93,
                      694.47,  782.69,  879.35,  985.25,
                     1101.26, 1228.36, 1367.60, 1520.15,
                     1687.28, 1870.38, 2070.97, 2290.73,
                     2531.49, 2795.26, 3084.24, 3400.82,
                     3747.66, 4127.64, 4543.93, 5000.00,]

matparams_erb_32ch = [ 33.97,  37.21,  40.77,  44.67,
                       48.93,  53.61,  58.73,  64.35,
                       70.49,  77.23,  84.61,  92.70,
                      101.55, 111.26, 121.89, 133.54,
                      146.30, 160.28, 175.59, 192.37,
                      210.75, 230.89, 252.96, 277.13,
                      303.61, 332.62, 364.40, 399.23,
                      437.37, 479.17, 524.96, 575.12,]

matparams_delay_32ch = [ 224.90, 205.28, 187.38, 171.03,
                         156.12, 142.50, 130.07, 118.72,
                         108.37,  98.92,  90.29,  82.41,
                          75.23,  68.66,  62.68,  57.21,
                          52.22,  47.66,  43.51,  39.71,
                          36.25,  33.09,  30.20,  27.57,
                          25.16,  22.97,  20.96,  19.14,
                          17.47,  15.94,  14.55,  13.28,]

def test_fir_default_cfs():
    g = gtfb()
    assert np.max(g.cfs - matparams_cf_32ch) < .005
    
def test_fir_default_erb():
    g = gtfb()
    assert np.max(1.019*g.ERB - matparams_erb_32ch) < .005
